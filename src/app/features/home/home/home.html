<app-navbar></app-navbar>
<div class="container mx-auto max-w-full p-4 md:max-w-4xl md:my-32">
  <h1 class="text-2xl font-bold mb-4 text-center">Dienstplan</h1>
  <div class="overflow-x-auto">
    <table class="min-w-full table-auto border-collapse border border-gray-300">
      <thead>
        <tr class="bg-gray-100">
          <th class="sticky left-0 bg-gray-100 z-20 border border-gray-300 px-4 py-2 text-center">Dienste</th>
          <th class="border border-gray-300 px-4 py-2 text-center">Zeit</th>
          @for (date of dates(); track date) {
            <th class="border border-gray-300 px-4 py-2 text-center">{{ getWeekdayShort(date) }} {{ date | date:'dd.MM.' }}</th>
          }
        </tr>
      </thead>
      <tbody>
        @for (service of services(); track service.name; let i = $index) {
          <tr class="hover:bg-gray-50">
            <td class="sticky left-0 bg-white z-10 border border-gray-300 p-1 font-medium text-center">
              {{ service.name }}<br>{{ getPeopleIcons(service.peopleNeeded) }}
            </td>
            <td class="border border-gray-300 px-4 py-2 text-center min-w-33">{{ service.time }}</td>
            @for (date of dates(); track date; let j = $index) {
              <td class="border border-gray-300 px-4 py-2 text-center">
                @if (isApplicable(service, date)) {
                  <input type="number" max="999" [(ngModel)]="assignments()[i][j]" class="w-full text-center border border-gray-200 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
                  <br>
                  @if (confirmed()[i][j]) {
                    <button (click)="toggleConfirmed(i, j)" class="mt-1 text-red-500 text-xl">✗</button>
                  } @else {
                    <button (click)="toggleConfirmed(i, j)" class="mt-1 text-green-500 text-xl">✓</button>
                  }
                }
              </td>
            }
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>
